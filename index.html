<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orphanage Management System (CiviCRM-style)</title>
    <style>
        body { font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; margin: 0; background: #f5f5f5; color: #333; }
        header { background: #003366; color: white; padding: 15px 20px; }
        header h1 { margin: 0; font-size: 24px; }
        nav { background: #004488; padding: 10px; }
        nav a { color: white; margin: 0 15px; text-decoration: none; font-weight: bold; }
        nav a:hover { text-decoration: underline; }
        .container { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: white; border: 1px solid #ddd; border-radius: 5px; padding: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .card h3 { margin-top: 0; color: #003366; }
        .card .number { font-size: 36px; font-weight: bold; color: #0055aa; }
        table { width: 100%; border-collapse: collapse; background: white; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background: #eef5ff; color: #003366; }
        .btn { background: #0055aa; color: white; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; }
        .btn:hover { background: #003366; }
        .btn-small { padding: 5px 8px; font-size: 12px; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tabs { overflow: hidden; border-bottom: 1px solid #ddd; margin-bottom: 20px; }
        .tabs button { background: none; border: none; padding: 10px 20px; cursor: pointer; font-weight: bold; }
        .tabs button.active { border-bottom: 3px solid #0055aa; color: #0055aa; }
        form { background: white; padding: 20px; border: 1px solid #ddd; border-radius: 5px; }
        label { display: block; margin: 10px 0 5px; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
    </style>
</head>
<body>
    <header>
        <h1>Hope Home Orphanage Management System</h1>
    </header>
    <nav>
        <a href="#dashboard" onclick="showTab('dashboard')">Dashboard</a>
        <a href="#children" onclick="showTab('children')">Children</a>
        <a href="#cases" onclick="showTab('cases')">Cases</a>
        <a href="#sponsorships" onclick="showTab('sponsorships')">Sponsorships</a>
        <a href="#sponsors" onclick="showTab('sponsors')">Sponsors</a>
    </nav>

    <div class="container">
        <!-- Dashboard -->
        <div id="dashboard" class="tab-content active">
            <h2>Dashboard</h2>
            <div class="dashboard">
                <div class="card">
                    <h3>Total Children</h3>
                    <div class="number" id="totalChildren">0</div>
                </div>
                <div class="card">
                    <h3>Active Cases</h3>
                    <div class="number" id="activeCases">0</div>
                </div>
                <div class="card">
                    <h3>Sponsored Children</h3>
                    <div class="number" id="sponsoredChildren">0</div>
                </div>
                <div class="card">
                    <h3>Total Sponsors</h3>
                    <div class="number" id="totalSponsors">0</div>
                </div>
            </div>
        </div>

        <!-- Children -->
        <div id="children" class="tab-content">
            <h2>Children <button class="btn" onclick="showForm('childForm')">Add New Child</button></h2>
            <div id="childForm" style="display:none;">
                <form onsubmit="addChild(event)">
                    <label>Name</label><input type="text" id="childName" required>
                    <label>Date of Birth</label><input type="date" id="childDOB" required>
                    <label>Arrival Date</label><input type="date" id="childArrival" required>
                    <label>Notes</label><textarea id="childNotes"></textarea>
                    <button type="submit" class="btn">Save Child</button>
                </form>
            </div>
            <table id="childrenTable">
                <thead><tr><th>ID</th><th>Name</th><th>Age</th><th>Arrival</th><th>Sponsored</th><th>Actions</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- Cases -->
        <div id="cases" class="tab-content">
            <h2>Cases <button class="btn" onclick="showForm('caseForm')">Add New Case</button></h2>
            <div id="caseForm" style="display:none;">
                <form onsubmit="addCase(event)">
                    <label>Child</label><select id="caseChild" required></select>
                    <label>Case Type</label><select id="caseType" required>
                        <option>New Intake</option><option>Ongoing Care</option><option>Medical</option><option>Adoption</option><option>Reunification</option>
                    </select>
                    <label>Notes</label><textarea id="caseNotes"></textarea>
                    <button type="submit" class="btn">Save Case</button>
                </form>
            </div>
            <table id="casesTable">
                <thead><tr><th>ID</th><th>Child</th><th>Type</th><th>Status</th><th>Actions</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- Sponsorships -->
        <div id="sponsorships" class="tab-content">
            <h2>Sponsorships <button class="btn" onclick="showForm('sponsorshipForm')">New Sponsorship</button></h2>
            <div id="sponsorshipForm" style="display:none;">
                <form onsubmit="addSponsorship(event)">
                    <label>Child</label><select id="sponsorChild" required></select>
                    <label>Sponsor</label><select id="sponsorName" required></select>
                    <label>Amount (monthly)</label><input type="number" id="sponsorAmount" required>
                    <label>Start Date</label><input type="date" id="sponsorStart" required>
                    <button type="submit" class="btn">Save Sponsorship</button>
                </form>
            </div>
            <table id="sponsorshipsTable">
                <thead><tr><th>Child</th><th>Sponsor</th><th>Amount</th><th>Start Date</th><th>Status</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>

        <!-- Sponsors -->
        <div id="sponsors" class="tab-content">
            <h2>Sponsors <button class="btn" onclick="showForm('sponsorForm')">Add Sponsor</button></h2>
            <div id="sponsorForm" style="display:none;">
                <form onsubmit="addSponsor(event)">
                    <label>Name</label><input type="text" id="sponsorFullName" required>
                    <label>Email</label><input type="email" id="sponsorEmail">
                    <label>Phone</label><input type="text" id="sponsorPhone">
                    <button type="submit" class="btn">Save Sponsor</button>
                </form>
            </div>
            <table id="sponsorsTable">
                <thead><tr><th>ID</th><th>Name</th><th>Email</th><th>Phone</th><th>Children Sponsored</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script>
        let children = JSON.parse(localStorage.getItem('children')) || [];
        let cases = JSON.parse(localStorage.getItem('cases')) || [];
        let sponsors = JSON.parse(localStorage.getItem('sponsors')) || [];
        let sponsorships = JSON.parse(localStorage.getItem('sponsorships')) || [];

        function saveData() {
            localStorage.setItem('children', JSON.stringify(children));
            localStorage.setItem('cases', JSON.stringify(cases));
            localStorage.setItem('sponsors', JSON.stringify(sponsors));
            localStorage.setItem('sponsorships', JSON.stringify(sponsorships));
            updateDashboard();
        }

        function updateDashboard() {
            document.getElementById('totalChildren').textContent = children.length;
            document.getElementById('activeCases').textContent = cases.filter(c => c.status !== 'Closed').length;
            document.getElementById('sponsoredChildren').textContent = sponsorships.length;
            document.getElementById('totalSponsors').textContent = sponsors.length;
        }

        function calculateAge(dob) {
            const birth = new Date(dob);
            const today = new Date();
            let age = today.getFullYear() - birth.getFullYear();
            const m = today.getMonth() - birth.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < birth.getDate())) age--;
            return age;
        }

        function renderChildren() {
            const tbody = document.querySelector('#childrenTable tbody');
            tbody.innerHTML = '';
            children.forEach((child, i) => {
                const sponsored = sponsorships.some(s => s.childId === i);
                const row = `<tr>
                    <td>${i+1}</td>
                    <td>${child.name}</td>
                    <td>${calculateAge(child.dob)}</td>
                    <td>${child.arrival}</td>
                    <td>${sponsored ? 'Yes' : 'No'}</td>
                    <td><button class="btn-small" onclick="deleteChild(${i})">Delete</button></td>
                </tr>`;
                tbody.innerHTML += row;
            });
            populateChildSelects();
        }

        function renderCases() {
            const tbody = document.querySelector('#casesTable tbody');
            tbody.innerHTML = '';
            cases.forEach((c, i) => {
                const child = children[c.childId];
                const row = `<tr>
                    <td>${i+1}</td>
                    <td>${child ? child.name : 'Unknown'}</td>
                    <td>${c.type}</td>
                    <td>${c.status || 'Open'}</td>
                    <td><button class="btn-small" onclick="deleteCase(${i})">Delete</button></td>
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        function renderSponsorships() {
            const tbody = document.querySelector('#sponsorshipsTable tbody');
            tbody.innerHTML = '';
            sponsorships.forEach(s => {
                const child = children[s.childId];
                const sponsor = sponsors[s.sponsorId];
                const row = `<tr>
                    <td>${child ? child.name : 'Unknown'}</td>
                    <td>${sponsor ? sponsor.name : 'Unknown'}</td>
                    <td>$${s.amount}</td>
                    <td>${s.start}</td>
                    <td>Active</td>
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        function renderSponsors() {
            const tbody = document.querySelector('#sponsorsTable tbody');
            tbody.innerHTML = '';
            sponsors.forEach((s, i) => {
                const sponsoredCount = sponsorships.filter(sp => sp.sponsorId === i).length;
                const row = `<tr>
                    <td>${i+1}</td>
                    <td>${s.name}</td>
                    <td>${s.email || '-'}</td>
                    <td>${s.phone || '-'}</td>
                    <td>${sponsoredCount}</td>
                </tr>`;
                tbody.innerHTML += row;
            });
            populateSponsorSelects();
        }

        function populateChildSelects() {
            const selects = ['caseChild', 'sponsorChild'];
            selects.forEach(id => {
                const select = document.getElementById(id);
                if (select) {
                    select.innerHTML = '<option value="">Select Child</option>';
                    children.forEach((child, i) => {
                        const opt = document.createElement('option');
                        opt.value = i;
                        opt.textContent = child.name;
                        select.appendChild(opt);
                    });
                }
            });
        }

        function populateSponsorSelects() {
            const select = document.getElementById('sponsorName');
            if (select) {
                select.innerHTML = '<option value="">Select Sponsor</option>';
                sponsors.forEach((s, i) => {
                    const opt = document.createElement('option');
                    opt.value = i;
                    opt.textContent = s.name;
                    select.appendChild(opt);
                });
            }
        }

        function addChild(e) {
            e.preventDefault();
            const child = {
                name: document.getElementById('childName').value,
                dob: document.getElementById('childDOB').value,
                arrival: document.getElementById('childArrival').value,
                notes: document.getElementById('childNotes').value
            };
            children.push(child);
            saveData();
            renderChildren();
            e.target.reset();
            showForm('childForm');
        }

        function addCase(e) {
            e.preventDefault();
            const c = {
                childId: parseInt(document.getElementById('caseChild').value),
                type: document.getElementById('caseType').value,
                notes: document.getElementById('caseNotes').value,
                status: 'Open'
            };
            cases.push(c);
            saveData();
            renderCases();
            e.target.reset();
            showForm('caseForm');
        }

        function addSponsor(e) {
            e.preventDefault();
            const sponsor = {
                name: document.getElementById('sponsorFullName').value,
                email: document.getElementById('sponsorEmail').value,
                phone: document.getElementById('sponsorPhone').value
            };
            sponsors.push(sponsor);
            saveData();
            renderSponsors();
            e.target.reset();
            showForm('sponsorForm');
        }

        function addSponsorship(e) {
            e.preventDefault();
            const s = {
                childId: parseInt(document.getElementById('sponsorChild').value),
                sponsorId: parseInt(document.getElementById('sponsorName').value),
                amount: document.getElementById('sponsorAmount').value,
                start: document.getElementById('sponsorStart').value
            };
            sponsorships.push(s);
            saveData();
            renderSponsorships();
            e.target.reset();
            showForm('sponsorshipForm');
        }

        function deleteChild(i) {
            if (confirm('Delete this child record?')) {
                children.splice(i, 1);
                saveData();
                renderChildren();
            }
        }

        function deleteCase(i) {
            if (confirm('Delete this case?')) {
                cases.splice(i, 1);
                saveData();
                renderCases();
            }
        }

        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            if (tabId === 'children') renderChildren();
            if (tabId === 'cases') renderCases();
            if (tabId === 'sponsorships') renderSponsorships();
            if (tabId === 'sponsors') renderSponsors();
        }

        function showForm(formId) {
            const form = document.getElementById(formId);
            form.style.display = form.style.display === 'block' ? 'none' : 'block';
        }

        // Initial render
        updateDashboard();
        renderChildren();
        renderCases();
        renderSponsorships();
        renderSponsors();
        populateChildSelects();
        populateSponsorSelects();
    </script>
</body>
</html>
